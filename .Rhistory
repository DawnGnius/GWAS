# data
n <- 100
p <- 100000
# p.afaf   ancestral population allele frequency p
p.afaf <- runif(p, min=0.1, max=0.9)
# data
n <- 1000
n.case <- 500
n.control <- 500
p <- 100000
# p.afaf   ancestral population allele frequency p
p.afaf <- runif(p, min=0.1, max=0.9)
sample.case <- matrix(rep(0, n.case*p))
sample.control <- matrix(rep(0, n.control*p))
# case
idx <- sample(1:2, n.case, prob=c(0.6, 0.4))
idx <- sample(1:2, n.case, prob=c(0.6, 0.4), replace = TRUE)
head(idx, 100)
length(idx==2)
length(which(idx==2))
# data
n <- 1000
n.case <- 500
n.control <- 500
p <- 100000
fst <- 0.01
# p.afaf   ancestral population allele frequency p
p.afaf <- runif(p, min=0.1, max=0.9)
# p.af    allele frequencies
rbeta1 <- function(p){
rbeta(1, p*(1-fst)/fst, (1-p)*(1-fst)/fst)
}
p.af <- unlist(lapply(p.afaf, rbeta1))
knitr::opts_chunk$set(echo = TRUE)
citation("mclust")
num.pc <- 1:200
errorRate <- NULL
for (num in num.pc) {
pcs <- fit.pca$x[,1:num]
# Clustering by PAM with k = 3
fit.pam <- pam(pcs, k = 3, metric = "euclidean")
cluster.pam <- fit.pam$clustering
# Classification error rate
error.PAM <- classError(cluster.pam, data.type)$errorRate
errorRate <- c(errorRate, error.PAM)
}
source('~/Codes/GWAS/Club6_FDP/data_preparation.R', echo=TRUE)
source('~/Codes/GWAS/Club6_FDP/data_preparation.R', echo=TRUE)
source('~/Codes/GWAS/Club6_FDP/data_preparation.R', echo=TRUE)
CHB <- CHB[-1, -1]
head(CHB)
CHB <- read.csv('./Club6_FDP/genevar/CHB.csv')
head(CHB)
CHB <- CHB[, -1]
head(CHB)
head(CEU)
express.CHB <- read.csv('./Club6_FDP/genevar/CHB_180_gene_profile.txt')
head(express.CHB)
express.CHB <- read.csv('./Club6_FDP/genevar/CHB_180_gene_profile.txt')
express.CEU <- read.csv('./Club6_FDP/genevar/CEUp_240_gene_profile.txt')
tt <- read.csv('./Club6_FDP/genevar/tmp.txt')
View(tt)
tt <- read.csv('./Club6_FDP/genevar/tmp.txt', sep='\t')
View(tt)
source('~/Codes/GWAS/Club6_FDP/realData.R', echo=TRUE)
express.JPT <- read.csv('./Club6_FDP/genevar/JPT_180_gene_profile.txt', sep='\t')
express.YRI <- read.csv('./Club6_FDP/genevar/YRIp_240_gene_profile.txt', sep='\t')
rm('express.CEU')
rm('tt')
express.CEU <- read.csv('./Club6_FDP/genevar/CEUp_240_gene_profile.txt', sep='\t')
express.CEU <- read.csv('./Club6_FDP/genevar/CEUp_240_gene_profile.txt', sep='\t')
rm('microarray')
save.image("~/Codes/GWAS/Club6_FDP/genevar/dat.RData")
